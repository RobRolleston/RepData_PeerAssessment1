---
title: "Reproducible Research: Peer Assessment 1"
author: Rob Rolleston
output: 
  html_document:
    keep_md: true
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=6, fig.height=3, fig.path='figure/',
                      echo=TRUE, warning=FALSE, message=FALSE)
```

## Loading and preprocessing the data
First, load the required libaries.  
Second, read the raw ZIP file, convert the date strings to date objects, and leave missing values as "NA".  
Finally, convert the data table into a dplyr table.
The data will reside in a dplyr table: "data".
```{r}
library(ggplot2, quietly = TRUE, verbose=FALSE, warn.conflicts = FALSE)
library(dplyr, quietly = TRUE, verbose=FALSE, warn.conflicts = FALSE)

data <- read.csv(unz("activity.zip", "activity.csv"), stringsAsFactors = FALSE)
data$date <- as.Date(data$date, format="%Y-%m-%d")
data <- tbl_df(data)
```


## What is mean total number of steps taken per day?
Note: *In this analysis, the missing values are ignored.*
```{r}
dataByDay <- data %>% filter(!is.na(steps)) %>% group_by(date) %>% summarize(dailyTotal=sum(steps))
dailyMean <- mean(dataByDay$dailyTotal)
dailyMedian <- median(dataByDay$dailyTotal)
```
### Histogram of Daily Steps
```{r "dailyHistogram"}
ggplot(dataByDay, aes(dailyTotal)) + geom_histogram()
```

### Mean and median
The mean total number of steps is `r formatC(mean(dataByDay$dailyTotal), format="f", digits=1)`, and the median is `r median(dataByDay$dailyTotal)`.

## What is the average daily activity pattern?
Note: *In this analysis, the missing values are ignored.*
```{r }
dataByInterval <- data %>% filter(!is.na(steps)) %>% group_by(interval) %>% summarize(intervalAvg=mean(steps))
intervalMax <- max(dataByInterval$intervalAvg)
topInterval <- top_n(dataByInterval, 1, intervalAvg)
```
```{r "intervalLinegraph"}
ggplot(dataByInterval, aes(interval, intervalAvg)) + geom_line()
```

Interval # `r topInterval$interval` has the highest average, with a value of `r topInterval$intervalAvg`

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?


```{r echo=FALSE}
remove(data, dataByDay, dataByInterval, dailyMean, dailyMedian, intervalMax)
```
